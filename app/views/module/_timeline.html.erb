<!--<link rel="stylesheet" type="text/css" href="css/VerticalTimeline/component.css"/>-->
<!--<link rel="stylesheet" type="text/css" href="css/default.css"/>-->
<!--<link rel="stylesheet" type="text/css" href="css/default.css"/>-->

<script src="js/modernizr.custom.js"></script>



<style>

        /* General Blueprint Style */
    @import url(http://fonts.googleapis.com/css?family=Lato:300,400,700);

    *, *:after, *:before {
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
    }

        /* Clearfix hack by Nicolas Gallagher: http://nicolasgallagher.com/micro-clearfix-hack/ */
    .clearfix:before, .clearfix:after {
        content: " ";
        display: table;
    }

    .clearfix:after {
        clear: both;
    }

    .main,
    .container > header {
        width: 95%;
        max-width: 69em;
        margin: 0 auto;
        padding: 0 1.875em 3.125em;
    }

    .container > header {
        padding: 2.875em 1.875em 1.875em;
    }

    .container > header h1 {
        font-size: 2.125em;
        line-height: 1.3;
        margin: 0;
        float: left;
        font-weight: 400;
    }

    .container > header span {
        display: block;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.5em;
        padding: 0 0 0.6em 0.1em;
    }

    .container > header nav {
        float: right;
    }

    .container > header nav a {
        display: block;
        float: left;
        position: relative;
        width: 2.5em;
        height: 2.5em;
        background: #fff;
        border-radius: 50%;
        color: transparent;
        margin: 0 0.1em;
        border: 4px solid #47a3da;
        text-indent: -8000px;
    }

    .container > header nav a:after {
        content: attr(data-info);
        color: #47a3da;
        position: absolute;
        width: 600%;
        top: 120%;
        text-align: right;
        right: 0;
        opacity: 0;
        pointer-events: none;
    }

    .container > header nav a:hover:after {
        opacity: 1;
    }

    .container > header nav a:hover {
        background: #47a3da;
    }

    .icon-drop:before,
    .icon-arrow-left:before {
        font-family: 'fontawesome';
        position: absolute;
        top: 0;
        width: 100%;
        height: 100%;
        speak: none;
        font-style: normal;
        font-weight: normal;
        line-height: 2;
        text-align: center;
        color: #47a3da;
        -webkit-font-smoothing: antialiased;
        text-indent: 8000px;
        padding-left: 8px;
    }

    .container > header nav a:hover:before {
        color: #fff;
    }

    .icon-drop:before {
        content: "\e000";
    }

    .icon-arrow-left:before {
        content: "\f060";
    }

    body {
        font-family: 'Lato', Calibri, Arial, sans-serif;
        color: #47a3da;
        background-color: #ffffff;

    }

    #timeline_a {
        position: static;
        color: #ffffff;
    }

    #timeline_a.hover {
        position: static;

        color: #ffffff;
    }

    @font-face {
        font-family: 'ecoico';
        src: url('../../../fonts/timelineicons/ecoico.eot');
        src: url('../../../fonts/timelineicons/ecoico.eot?#iefix') format('embedded-opentype'), url('../../../fonts/timelineicons/ecoico.woff') format('woff'), url('../../../fonts/timelineicons/ecoico.ttf') format('truetype'), url('../../../fonts/timelineicons/ecoico.svg#ecoico') format('svg');
        font-weight: normal;
        font-style: normal;

    }

        /* Made with http://icomoon.io/ */

    .cbp_tmtimeline {
        margin: 30px 0 0 0;
        padding: 0;
        list-style: none;
        position: relative;
    }

        /* The line */
    .cbp_tmtimeline:before {
        content: '';
        position: absolute;
        top: 0;
        bottom: 0;
        width: 10px;
        background: #afdcf8;
        left: 20%;
        margin-left: -10px;
    }

        /* The date/time */
    .cbp_tmtimeline > li .cbp_tmtime {
        display: block;
        width: 25%;
        padding-right: 100px;
        position: absolute;
    }

    .cbp_tmtimeline > li .cbp_tmtime span {
        display: block;
        text-align: right;
    }

    .cbp_tmtimeline > li .cbp_tmtime span:first-child {
        font-size: 0.9em;
        color: #bdd0db;
    }

    .cbp_tmtimeline > li .cbp_tmtime span:last-child {
        font-size: 2.9em;
        color: #3594cb;
    }

    .cbp_tmtimeline > li:nth-child(odd) .cbp_tmtime span:last-child {
        color: #6cbfee;
    }

        /* Right content */
    .cbp_tmtimeline > li .cbp_tmlabel {
        margin: 0 0 15px 25%;
        background: #3594cb;
        color: #fff;
        padding: 2em;
        font-size: 1.2em;
        font-weight: 300;
        line-height: 1.4;
        position: relative;
        border-radius: 5px;
    }

    .cbp_tmtimeline > li:nth-child(odd) .cbp_tmlabel {
        background: #6cbfee;
    }

    .cbp_tmtimeline > li .cbp_tmlabel h2 {
        margin-top: 0px;
        padding: 0 0 10px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.4);
    }

        /* The triangle */
    .cbp_tmtimeline > li .cbp_tmlabel:after {
        right: 100%;
        border: solid transparent;
        content: " ";
        height: 0;
        width: 0;
        position: absolute;
        pointer-events: none;
        border-right-color: #3594cb;
        border-width: 10px;
        top: 10px;
    }

    .cbp_tmtimeline > li:nth-child(odd) .cbp_tmlabel:after {
        border-right-color: #6cbfee;
    }

        /* The icons */
    .cbp_tmtimeline > li .cbp_tmicon {
        width: 40px;
        height: 40px;
        font-family: 'ecoico';
        speak: none;
        font-style: normal;
        font-weight: normal;
        font-variant: normal;
        text-transform: none;
        font-size: 1.4em;
        line-height: 40px;
        -webkit-font-smoothing: antialiased;
        position: absolute;
        color: #fff;
        background: #46a4da;
        border-radius: 50%;
        box-shadow: 0 0 0 8px #afdcf8;
        text-align: center;
        left: 20%;
        top: 0;
        margin: 0 0 0 -25px;
    }

    .cbp_tmicon-phone:before {
        content: "\e000";
    }

    .cbp_tmicon-screen:before {
        content: "\e001";
    }

    .cbp_tmicon-mail:before {
        content: "\e002";
    }

    .cbp_tmicon-earth:before {
        content: "\e003";
    }

        /* Example Media Queries */
    @media screen and (max-width: 65.375em) {

        .cbp_tmtimeline > li .cbp_tmtime span:last-child {
            font-size: 1.5em;
        }
    }

    @media screen and (max-width: 47.2em) {
        .cbp_tmtimeline:before {
            display: none;
        }

        .cbp_tmtimeline > li .cbp_tmtime {
            width: 100%;
            position: relative;
            padding: 0 0 20px 0;
        }

        .cbp_tmtimeline > li .cbp_tmtime span {
            text-align: left;
        }

        .cbp_tmtimeline > li .cbp_tmlabel {
            margin: 0 0 30px 0;
            padding: 1em;
            font-weight: 400;
            font-size: 95%;
        }

        .cbp_tmtimeline > li .cbp_tmlabel:after {
            right: auto;
            left: 20px;
            border-right-color: transparent;
            border-bottom-color: #3594cb;
            top: -20px;
        }

        .cbp_tmtimeline > li:nth-child(odd) .cbp_tmlabel:after {
            border-right-color: transparent;
            border-bottom-color: #6cbfee;
        }

        .cbp_tmtimeline > li .cbp_tmicon {
            position: relative;
            float: right;
            left: auto;
            margin: -55px 5px 0 0px;
        }
    }


</style>



<div class="main">


  <ul class="cbp_tmtimeline">

    <% issues.each do |issue| %>
        <li>
          <time class="cbp_tmtime" datetime=""><span><%= issue.created_at.strftime("%r") %></span>
            <span><%= issue.created_at.strftime("%F") %></span></time>
          <div class="cbp_tmicon cbp_tmicon-phone"></div>
          <div class="cbp_tmlabel">
            <a href="<%= shownews_url(issue) %>" id="timeline_a"><h2 align="center"><%= issue.title %></h2></a>

            <% content = strip_tags((issue.content)) %>
            <a href="<%= shownews_url(issue) %>" id="timeline_a">
              <p><%= truncate(sanitize(content), :length => 400) %></p>
            </a>
          </div>
        </li>
    <% end %>

    <li>
      <time class="cbp_tmtime" datetime=""><span><%= society.created_at.strftime("%r") %></span>
        <span><%= society.created_at.strftime("%F") %></span></time>
      <div class="cbp_tmicon cbp_tmicon-phone"></div>
      <div class="cbp_tmlabel">
        <a href="#top" id="timeline_a"><h2><%= society.to_s %> 于<%= society.created_at.strftime("%F") %> 在这里被创建</h2></a>
        </a>
      </div>
    </li>
  </ul>
</div>




<script src="js/masonry.pkgd.min.js"></script>



<script>
    $(function () {

        var masonryNode = $('#masonry');
        masonryNode.imagesLoaded(function () {
            masonryNode.masonry({
                itemSelector: '.thumbnail',
                isFitWidth: true
            });
        });


        // 首先将新元素添加到页面容器中

        masonryNode.append(newItems);
// 等待新元素中的图片加载完毕
        newItems.imagesLoaded(function () {

// 调用瀑布流布局的appended方法
            masonryNode.masonry('appended', newItems);
        });

    });

    var ghostNode = $('#masonry_ghost').find('.thumbnail'), i, ghostIndexArray = [];
    var ghostCount = ghostNode.length;
    for (i = 0; i < ghostCount; i++) {
        ghostIndexArray[i] = i;
    }
    ghostIndexArray.sort(function (a, b) {
        if (Math.random() > 0.5) {
            return a - b;
        } else {
            return b - a;
        }
    });


    var nextDataNumber = 5;
    var ajaxLoading = false;
    var docNode = $(document);

    var ulNode = $('ul.timeline');

    function initLiNodes() {
        var liNodes = ulNode.find('li'), count = liNodes.length, i, liNode, leftCount = nextDataNumber * 2;
        for (i = 0; i < count; i++) {
            liNode = $(liNodes.get(i));
            if (i % 2 !== 0) {
                liNode.addClass('alt');
            } else {
                liNode.removeClass('alt');
            }
            liNode.find('.number').text(leftCount + count - i);
        }
    }


    $('#fetchNextData').click(function () {
        var $this = $(this);
        $this.addClass('disabled').text('正在加载后二十条数据...');
        ajaxLoading = true;

        $.get('./version_data_' + nextDataNumber + '.txt', function (data) {
            ajaxLoading = false;
            ulNode.append(data);
            $this.removeClass('disabled').text('后二十条数据');
            nextDataNumber--;

            if (nextDataNumber === 0) {
                $this.hide();
            }

            initLiNodes();
        });

    });

    initLiNodes();

    $(window).scroll(function () {

        if ($(document).height() - $(window).height() - $(document).scrollTop() < 2) {

            if (!imagesLoading) {
                appendToMasonry();
            }

        }

    });
</script>